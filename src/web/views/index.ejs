<!DOCTYPE html>
<html lang="en">
<%- include(`${appcfg.app.rootFolder}/node_modules/web_resources/src/web/templates/_top.ejs`); %>
<!--------------------------------------------------------------------------------------------------------------------->
<div class="overflow-x-auto rounded-box border border-base-300 bg-base-100">
    <table class="table">
        <!-- head -->
        <thead>
        <tr>
            <th>Name</th>
            <th></th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        <!-- row 1 -->
        <tr v-for="worker in workers">
            <td>
                ${worker.title}
                <br/>
                <span class="label">
                    ${worker.description}
                </span>
                <br>

            </td>
            <td>
                <span class="badge badge-ghost badge-sm" v-if="workerStatusMap[worker.name]">

                    <button class="btn btn-square btn-xs" v-if="workerStatusMap[worker.name].sifStatus ==='i'">
                      <span class="loading loading-spinner"></span>
                    </button>
                    <button class="btn btn-success btn-square  btn-xs"
                            v-if="workerStatusMap[worker.name].sifStatus ==='s'">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
                          <path fill-rule="evenodd"
                                d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z"
                                clip-rule="evenodd"/>
                      </svg>
                    </button>
                    <button class="btn btn-error btn-square  btn-xs"
                            v-if="workerStatusMap[worker.name].sifStatus ==='f'">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
                      <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"/>
                    </svg>
                    </button>
                    ${workerStatusMap[worker.name]?.updatedAt}
                </span>
            </td>
            <td>
                <button class="btn btn-primary btn-sm"
                        :class="{'btn-disabled':workerStatusMap[worker.name].sifStatus ==='i'}"
                        @click="runWorker(worker)">执行
                </button>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<!--------------------------------------------------------------------------------------------------------------------->
<%- include(`${appcfg.app.rootFolder}/node_modules/web_resources/src/web/templates/_bottom.ejs`); %>
<script type="text/javascript">
    <%- include(`${appcfg.app.rootFolder}/src/web/views/index.js`); %>
</script>
</html>